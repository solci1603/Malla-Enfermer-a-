<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Malla Curricular de Enfermería</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f4f9fc;
      color: #333;
      margin: 0;
      padding: 2rem;
    }
    h1 {
      text-align: center;
      margin-bottom: 2rem;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1.5rem;
    }
    .year {
      background: #fff;
      border-radius: 10px;
      padding: 1rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .semester, .annual {
      margin-bottom: 1rem;
    }
    h2, h3 {
      text-align: center;
      color: #2b5d7d;
    }
    .subject {
      background-color: #dceefc;
      padding: 0.5rem;
      margin: 0.3rem 0;
      border-radius: 5px;
      cursor: pointer;
      position: relative;
      transition: background-color 0.3s;
    }
    .subject.completed {
      background-color: #c8e6c9;
      text-decoration: line-through;
    }
    .subject.locked {
      background-color: #f8d7da;
      cursor: not-allowed;
    }
    .subject.locked::after {
      content: attr(data-tooltip);
      position: absolute;
      top: 100%;
      left: 0;
      background-color: #444;
      color: white;
      font-size: 0.75rem;
      padding: 0.4rem;
      border-radius: 5px;
      white-space: pre-line;
      display: none;
      z-index: 2;
    }
    .subject.locked:hover::after {
      display: block;
    }
  </style>
</head>
<body>
  <h1>Malla Curricular de Enfermería</h1>
  <div class="grid" id="curriculum"></div>
  <script>
    const data = {
      "Primer Año": {
        "Primer Semestre": ["salud pública", "bioquímica", "biofísica", "estado y sociedad"],
        "Segundo Semestre": ["des. local y planif. estratégica", "epidemiologia y bioestadística", "aspec. psico-socio y cult. del des."],
        "Anuales": ["anatomía y fisiología", "nuevas tecn. de la inf. y com.", "cuidados de enfermería", "práctica profesional I"]
      },
      "Segundo Año": {
        "Tercer Semestre": ["psicología social e instit.", "microb. parasit e inmulóg.", "métod. de la investigación", "nutrición y dietoterapia"],
        "Cuarto Semestre": ["comunicación", "enf. salud mental y psiquiátrica", "enfermería del adulto mayor"],
        "Anuales": ["farmacología", "enfermería del adulto", "práctica profesional II"]
      },
      "Tercer Año": {
        "Quinto Semestre": ["ética y legisl. profesional"],
        "Sexto Semestre": ["cuid. críticos y emergentología"],
        "Anuales": ["lengua extranjera aplicada", "ed. para la salud en enfermería", "org. gest. y adm. de los servicios enf.", "enfer. materno-infanto-juvenil", "práctica profesional III"]
      }
    };

    const requisitos = {
      "farmacología": ["bioquímica", "biofísica"],
      "enfermería del adulto": ["anatomía y fisiología", "cuidados de enfermería", "práctica profesional I", "aspec. psico-socio y cult. del des."],
      "práctica profesional II": ["anatomía y fisiología", "cuidados de enfermería", "práctica profesional I", "aspec. psico-socio y cult. del des.", "enfermería del adulto", "enfermería del adulto mayor"],
      "microb. parasit e inmulóg.": ["anatomía y fisiología"],
      "métod. de la investigación": ["nuevas tecn. de la inf. y com.", "epidemiologia y bioestadística"],
      "enf. salud mental y psiquiátrica": ["anatomía y fisiología", "cuidados de enfermería", "práctica profesional I", "aspec. psico-socio y cult. del des.", "nutrición y dietoterapia"],
      "enfermería del adulto mayor": ["anatomía y fisiología", "cuidados de enfermería", "práctica profesional I", "aspec. psico-socio y cult. del des.", "nutrición y dietoterapia"],
      "enfer. materno-infanto-juvenil": ["anatomía y fisiología", "cuidados de enfermería", "práctica profesional I", "aspec. psico-socio y cult. del des.", "enfermería del adulto", "práctica profesional II", "nutrición y dietoterapia", "enfermería del adulto mayor"],
      "práctica profesional III": ["anatomía y fisiología", "cuidados de enfermería", "práctica profesional I", "aspec. psico-socio y cult. del des.", "enfermería del adulto", "práctica profesional II", "nutrición y dietoterapia", "enfermería del adulto mayor"]
    };

    const completadas = JSON.parse(localStorage.getItem('completadas') || '[]');

    function guardarProgreso() {
      localStorage.setItem('completadas', JSON.stringify(completadas));
    }

    function crearMateria(nombre) {
      const div = document.createElement('div');
      div.textContent = nombre;
      div.className = 'subject';

      const requisitosMateria = requisitos[nombre];
      const materiasPrimerAnio = Object.values(data['Primer Año']).flat();
      const tercerAnioMaterias = Object.values(data['Tercer Año']).flat();

      const debeEstarBloqueada = (requisitosMateria && !requisitosMateria.every(r => completadas.includes(r))) ||
        (tercerAnioMaterias.includes(nombre) && !materiasPrimerAnio.every(r => completadas.includes(r)));

      if (completadas.includes(nombre)) {
        div.classList.add('completed');
      } else if (debeEstarBloqueada) {
        div.classList.add('locked');
        const faltantes = requisitosMateria?.filter(r => !completadas.includes(r)) || [];
        if (tercerAnioMaterias.includes(nombre) && !materiasPrimerAnio.every(r => completadas.includes(r))) {
          faltantes.unshift('Todas las materias del Primer Año');
        }
        div.dataset.tooltip = 'Faltan: ' + faltantes.join(', ');
      } else {
        div.addEventListener('click', () => {
          completadas.push(nombre);
          guardarProgreso();
          location.reload();
        });
      }
      return div;
    }

    const contenedor = document.getElementById('curriculum');
    Object.entries(data).forEach(([anio, bloques]) => {
      const columna = document.createElement('div');
      columna.className = 'year';
      const h2 = document.createElement('h2');
      h2.textContent = anio;
      columna.appendChild(h2);

      Object.entries(bloques).forEach(([etiqueta, materias]) => {
        const bloque = document.createElement('div');
        bloque.className = etiqueta.toLowerCase().includes('anual') ? 'annual' : 'semester';
        const h3 = document.createElement('h3');
        h3.textContent = etiqueta;
        bloque.appendChild(h3);
        materias.forEach(materia => bloque.appendChild(crearMateria(materia)));
        columna.appendChild(bloque);
      });
      contenedor.appendChild(columna);
    });
  </script>
</body>
</html>
